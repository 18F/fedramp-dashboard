"use strict";!function(){function e(e,n){e.debug("FedRAMP Module Initializing"),n.$on("$stateChangeError",e.debug.bind(e))}angular.module("fedramp",["ui.router","fedramp.models","fedramp.services"]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension|blob|data):/)}]).run(e),e.$inject=["$log","$rootScope"]}(),function(){function e(e){e.debug("fedramp.model module initializing")}angular.module("fedramp.models",[]).run(e),e.$inject=["$log"]}(),function(){function e(e){e.debug("fedramp.services module initializing")}angular.module("fedramp.services",["fedramp.models"]).run(e),e.$inject=["$log"]}(),angular.module("fedramp").run(["$templateCache",function(e){e.put("src/fedramp/fedramp.html",'<header>\n    <div class="usa-grid">\n        <div class="usa-width-one-whole">\n            <!--<img class="header" src="img/fedramp.png"/>-->\n            <h1>FedRAMP</h1>\n        </div>\n    </div>\n\n</header>\n<ui-view></ui-view>\n'),e.put("src/fedramp/home/home.html",'<div class="usa-content">\n    <div class="usa-grid">\n        <div class="usa-width-one-third">\n            <div class="circle">\n                <h4>${{homeController.totalCostSavings()}}</h4>\n                <div>Cost Savings:</div>\n            </div>\n        </div>\n        <div class="usa-width-one-third">\n            <div class="circle">\n                <div>\n                    <h4>{{homeController.totalAuthorized()}}</h4>\n                    Total Authorized:\n                </div>\n            </div>\n        </div>\n        <div class="usa-width-one-third">\n            <div class="circle">\n                <h4>{{homeController.leveragedAtos()}}</h4>\n                <div>Leveraged ATOs:</div>\n            </div>\n        </div>\n    </div>\n    <div style="text-align:center;margin-top:20px;margin-bottom:20px;"> Search by </div>\n    <div ng-show="homeController.hasData()">\n        <div class="filters usa-grid">\n            <div class="usa-width-one-fourth">\n                <button id="filterByCSP"\n                        ng-click="homeController.toggleFilter(\'csp\')">CSP\n                </button>\n            </div>\n            <div class="usa-width-one-fourth">\n                <button id="filterByCSO"\n                        type="radio"\n                        ng-click="homeController.toggleFilter(\'cso\')">CSO\n                </button>\n            </div>\n            <div class="usa-width-one-fourth">\n                <button id="filterByAgency"\n                        ng-click="homeController.toggleFilter(\'agency\')">Agency\n                </button>\n            </div>\n            <div class="usa-width-one-fourth">\n                <button id="filterBy3PAO"\n                        ng-click="homeController.toggleFilter(\'3pao\')">3PAO\n                </button>\n            </div>\n        </div>\n        <div class="usa-grid" ng-show="!!homeController.filterType">\n            <div style="text-align:center;" class="usa-width-one-whole">\n                <div style="margin:0 auto;display:table;">\n                    <label for="filter">Filter using:</label>\n                    <select id="filter"\n                            ng-model="homeController.filter"\n                            ng-options="option for option in homeController.filterOptions"\n                            ng-change="homeController.applyFilter()">\n                        <option value=""></option>\n                    </select>\n                </div>\n                <a href="{{homeController.downloadUrl}}"\n                   download="{{homeController.filename()}}"\n                   ng-click="homeController.download()">\n                    Download\n                </a>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),function(){function e(e,n){function t(e){return e.pull().then(function(e){return e})}n.otherwise("/"),e.state("fedramp",{"abstract":!0,templateUrl:"src/fedramp/fedramp.html",resolve:{providers:t}}).state("fedramp.home",{url:"/",templateUrl:"src/fedramp/home/home.html",controller:"HomeController as homeController"}),t.$inject=["ProviderService"]}angular.module("fedramp").config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(){return n}function n(e){var n=this,t={Letter_Date:"letterDate",Letter_Expiration_Date:"letterExpirationDate",Authorization_Date:"authorizationDate",Authorizing_Letter_Last_Sign_Date:"authorizingLetterSignedDate",Authorizing_Agency:"authorizingAgency",Authorizing_Subagency:"authorizingSubagency",Active:"active",Include_In_Marketplace:"includeInMarketplace"};return n.letterDate=null,n.letterExpirationDate=null,n.authorizationDate=null,n.authorizingLetterSignedDate=null,n.authorizingAgency="",n.authorizingSubagency="",n.active="",n.includeInMarketplace="",n.init=function(e){if(!e)return n;for(var r in e)if(e.hasOwnProperty(r)){var o=t[r];o?n[o]=e[r]:n.hasOwnProperty(r)&&(n[r]=e[r])}return n},n.init(e)}angular.module("fedramp.models").factory("AtoLetter",e)}(),function(){function e(e){function n(n){var t=this,r={Cloud_Service_Provider_Name:"name",Cloud_Service_Provider_Package:"pkg",Path:"path",Designation:"designation",Package_ID:"pkgId",Service_Model:"serviceModel",Deployment_Model:"deploymentModel",Impact_Level:"impactLevel",Original_Authorization_Date:"authorizationDate",Original_Expiration_Date:"expirationDate",Sponsoring_Agency:"sponsoringAgency",Sponsoring_Subagency:"sponsoringSubagency",Active:"active",CSP_URL:"cspUrl",Underlying_CSP_Package_ID:"underlyingCspPackages",Stage:"stage",Leveraged_ATO_Letters:"atoLetters"};return t.name="",t.pkg="",t.pkgId="",t.path="",t.designation="",t.serviceModel=[],t.deploymentModel="",t.impactLevel="",t.authorizationDate=null,t.expirationDate=null,t.sponsoringAgency="",t.sponsoringSubagency="",t.active="",t.cspUrl="",t.underlyingCspPackages=[],t.stage="",t.atoLetters=[],t.init=function(n){if(n){for(var o in n)if(n.hasOwnProperty(o)){var i=r[o];if(i)if("atoLetters"===i)for(var a=0;a<n[o].length;a++)t[i].push(new e(n[o][a]));else t[i]=n[o];else if(t.hasOwnProperty(o))if("atoLetters"===o)for(var l=0;l<n[o].length;l++)t[o].push(new e(n[o][l]));else t[o]=n[o]}return t}},t.hash=function(){var e=""+t.name+t.pkg+t.pkgId+t.sponsoringAgency;return 0===e.length?null:e},t.init(n)}return n}angular.module("fedramp.models").factory("Provider",e),e.$inject=["AtoLetter"]}(),function(){function e(){return n}function n(e){function n(){var e=new Date,n=e.getDate(),t=e.getMonth()+1,r=e.getFullYear();return n<10&&(n="0"+n),t<10&&(t="0"+t),t+"/"+n+"/"+r}var t=this;return t.lastRefresh=null,t.init=function(e){if(e)for(var n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(t[n]=e[n]);return t},t.refresh=function(){return t.lastRefresh=n(),t.lastRefresh},t.clearRefresh=function(){t.lastRefresh=null},t.needsRefresh=function(){return t.lastRefresh!==n()},t.init(e)}angular.module("fedramp.services").factory("Settings",e)}(),function(){function e(e){function n(e,n){return Papa.unparse(e,n)}function t(e){for(var n=[],t=0;t<e.length;t++){var i=e[t],a=r(i),l=e[t].atoLetters;if(l&&0!==l.length)for(var u=0;u<e[t].atoLetters.length;u++){var s=angular.copy(a),c=e[t].atoLetters[u],g=o(c);s=angular.extend(s,g),n.push(s)}else n.push(a)}return n}function r(e){return{"Cloud Service Provider Name":e.name,Designation:e.designation,"Service Model":e.serviceModel.join(","),"Deployment Model":e.deploymentModel,"Impact Level":e.impactLevel,Sponsoring_Agency:e.sponsoringAgency,Sponsoring_Subagency:e.sponsoringSubagency}}function o(e){return{"Letter Date":e.letterDate,"Letter Expiration Date":e.letterExpirationDate,"Authorization Date":e.authorizationDate,"Authorizing Letter Signed Date":e.authorizingLetterSignedDate,"Authorizing Agency":e.authorizingAgency,"Authorizing Subagency":e.authorizingSubagency,"Letter Active":e.active,"Include In Marketplace":e.includeInMarketplace}}var i=this;i.flattenProviders=t,i.toCsv=n}angular.module("fedramp.services").service("CsvService",e),e.$inject=["$log"]}(),function(){function e(e){var n=this;n.pull=function(n){return e.get(n).then(function(e){return e.data})}}angular.module("fedramp.services").service("DatasourceService",e),e.$inject=["$http"]}(),function(){function e(e,n,t,r,o){var i=this,a="https://raw.githubusercontent.com/18F/fedramp-micropurchase/master/data/data.json";i.pull=function(){return o.pull(a).then(function(e){for(var n=(e.meta,e.data),o=new t,i=0;i<n.length;i++){var a=new r(n[i]);o.update(a.hash(),a)}return o.all()})}}angular.module("fedramp.services").service("ProviderService",e),e.$inject=["$log","StorageManager","StorageProvider","Provider","DatasourceService"]}(),function(){function e(){return n}function n(e){function n(){return"undefined"==typeof Storage?"Local storage is not supported":null}function t(){var e=[],n=JSON.parse(localStorage.getItem(a.storageContainer));if(n)for(var t in n)e.push(a.transform(n[t]));return e}function r(e){var n=JSON.parse(localStorage.getItem(a.storageContainer));return n&&n[e]?a.transform(n[e]):null}function o(e,n){var t=JSON.parse(localStorage.getItem(a.storageContainer));t||(t={}),e&&(t[e]=n,a.transform(t[e]),localStorage.setItem(a.storageContainer,JSON.stringify(t)))}function i(){localStorage.getItem(a.storageContainer)&&localStorage.removeItem(a.storageContainer)}var a=this;return a.storageContainer="default",a.init=function(e){var t=n();if(t&&0!==t.length)throw t;return e&&e.storageContainer&&(a.storageContainer=e.storageContainer),a},a.update=function(e,n){o(e,n)},a.byId=function(e){return r(e)},a.clear=function(){i()},a.all=function(){return t()},a.transform=function(e){return e},a.init(e)}angular.module("fedramp.services").factory("StorageManager",e)}(),function(){function e(e,n){function t(t){e.call(this);var r=this;return r.storageContainer="providers",r.transform=function(e){return new n(e)},r.init(t)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t}angular.module("fedramp.services").factory("StorageProvider",e),e.$inject=["StorageManager","Provider"]}(),function(){function e(e,n){function t(t){e.call(this);var r=this;return r.storageContainer="fedramp",r.transform=function(e){return new n(e)},r.init(t)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t}angular.module("fedramp.services").factory("StorageSettings",e),e.$inject=["StorageManager","Settings"]}(),function(){function e(e,n,t){var r=this,o="",i=null;r.title="FedRAMP",r.downloadUrl="#",r.filteredData=[],r.filterType="",r.filterOptions=[],r.filter="",r.hasData=function(){return n&&n.length>0},r.applyFilter=function(e,o){if(e=e?e:r.filterType,o=o?o:r.filter,!e||!o)return void(r.filteredData=n);var a,l,u,s,c=[];switch(e){case"csp":for(a=0;a<n.length;a++)l=n[a],l.name.indexOf(o)!==-1&&c.push(l);break;case"cso":for(a=0;a<n.length;a++)l=n[a],l.pkg.indexOf(o)!==-1&&c.push(l);break;case"agency":for(a=0;a<n.length;a++)if(l=n[a],(l.sponsoringAgency+l.sponsoringSubagency).indexOf(o)!==-1)c.push(l);else for(u=0;u<l.atoLetters.length;u++)if(s=l.atoLetters[u],(s.authorizingAgency+s.authorizingSubagency).indexOf(o)!==-1){c.push(l);break}break;case"3pao":}r.filteredData=c,r.downloadUrl="#",i=null;var g=t.toCsv(t.flattenProviders(c));g&&(i=new Blob([g],{type:"text/csv;charset=utf-8;"}),r.downloadUrl=window.URL.createObjectURL(i))},r.toggleFilter=function(e){if(r.filterType=e,o===e)return void(r.filterType="");o=e;var t,i,a,l,u=[];switch(e){case"csp":for(t=0;t<n.length;t++)i=n[t],i.name&&!u.includes(i.name)&&u.push(i.name);break;case"cso":for(t=0;t<n.length;t++)i=n[t],i.pkg&&!u.includes(i.pkg)&&u.push(i.pkg);break;case"agency":for(t=0;t<n.length;t++)for(i=n[t],i.sponsoringAgency&&!u.includes(i.sponsoringAgency)&&u.push(i.sponsoringAgency),i.sponsoringSubagency&&!u.includes(i.sponsoringSubagency)&&u.push(i.sponsoringSubagency),a=0;a<i.atoLetters.length;a++)l=i.atoLetters[a],l.authorizingAgency&&!u.includes(l.authorizingAgency)&&u.push(l.authorizingAgency),l.authorizingSubagency&&!u.includes(l.authorizingSubagency)&&u.push(l.authorizingSubagency);break;case"3pao":}r.filterOptions=u},r.download=function(){e.info("Download clicked"),navigator.msSaveBlob&&i&&navigator.msSaveBlob(i,r.filename())},r.filename=function(e){e||(e=new Date);var n=e.getDate(),t=e.getMonth()+1,r=e.getFullYear();return n<10&&(n="0"+n),t<10&&(t="0"+t),"fedramp-"+r+"-"+t+"-"+n+".csv"},r.totalAuthorized=function(){for(var e=0,t=[],r=0;r<n.length;r++){var o=n[r];o.name&&!t.includes(o.name)&&(t.push(o.name),e++)}return e},r.totalCostSavings=function(){return Number(25e4*r.leveragedAtos()).toLocaleString("en")},r.leveragedAtos=function(){var e=0;return n.forEach(function(t){e+=r.calcCSPReuse(t,n,!1)}),e},r.calcCSPReuse=function(e,n,t){var r=e.atoLetters.length,o=n.filter(function(n){if(n.underlyingCspPackages)return n.underlyingCspPackages.includes(e.pkgId)}),i=o.length;return o.length>0&&(i+=o.map(function(e){return e.atoLetters.length}).reduce(function(e,n){return e+n})),r+i}}angular.module("fedramp").controller("HomeController",e),e.$inject=["$log","providers","CsvService"]}();